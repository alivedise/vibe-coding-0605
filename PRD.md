# Complex project testing prompt for code assistant tools

## Version

2025.06.05

## 概述

開發一個基於網頁的城市模擬器，使用 JavaScript 和 vue3 框架，模擬城市發展、人口活動、經濟系統和建築管理。此應用程序將以網格地圖為基礎展示城市的發展過程。

## 技術架構

- 使用 JavaScript 作為開發語言
- 使用 vue3 框架，但核心邏輯應該盡可能只使用 vanilla JavaScript；vue3 只用於顯示資料
- 使用 Vite 作為構建工具和開發伺服器
- 使用 PNPM 作為包管理工具
- 使用 Faker 庫生成隨機人名、公司名和職位等數據

## 基本架構

- 採用一般遊戲的 Game Loop 系統
- 有一個主要的 GameStateManager 作為所有模組的管理者
- GameStateManager 下管理所有資源的管理者:
  ```mermaid
  graph TD;
    GameStateManager --> ResourceManager
    GameStateManager --> MapManager
    GameStateManager --> CitizenManager
    GameStateManager --> CompanyManager
    GameStateManager --> VehicleManager
    GameStateManager --> ProductManager
    GameStateManager --> RecipeManager
  ```
- GameStateManager 會在每次 tick 時將所有管理者資料封裝成 context 傳遞給所有 Manager 避免耦合

## 模組設計

- 所有的模組以 OOP 方式撰寫
- 跟自己沒有關係的模組應該以 Dependency Inject 的方式注入，最大程度的減少耦合
- 將所有的 enum 抽出在功能外寫在 constants/ 下

## 核心功能需求

### 地圖系統

- 創建一個網格式地圖，默認大小為 30x20 格
- 實現四種基本地形類型：草地、沙地、水域和山地
- 各地形以不同顏色顯示，並影響建築和道路的建設
- 實現隨機地圖生成器，能夠按照設定的比例生成多樣化地形

### 建築系統

- 支持至少三種建築類型：住宅、商業和工業
- 建築可自動生成或由玩家手動放置
- 建築具有不同大小（1x1 至 3x3 格子）
- 建築有獨特的顏色和標識，便於識別
- 建築之間不能重疊
- 每個建築有唯一ID，並與居民、工作和公司關聯

### 居民系統

- 居民自動出生於住宅區建築
- 居民具有姓名、性別、年齡、職業、心情、教育等級等屬性
- 居民能夠在地圖上移動，有非固定的行動模式（至少有工作、休息、移動，行為要可以擴充）
  - 居民上班亦即從住家移動(搭車或走路)到上班地點
  - 居民下班亦即從上班地點(搭車或走路)移動到住家
  - 居民假日會前往商業區或公園活動，或在家休息
- 居民的位置以小圓點顯示在地圖上，顏色根據居民ID自動生成
- 居民能夠根據教育等級應徵工作
- 居民具有擴展路徑算法，實現平滑的移動動畫

### 工作系統

- 不同建築類型提供不同類型的工作
- 每個工作有職位名稱、描述和所在位置
- 居民可以申請工作，並在工作地點工作
- 工作狀態（已佔用或空缺）應當被正確追蹤
- 工作可以被釋放，讓其他居民申請
- 每種工作會根據公司產業別產生不同實體或虛擬的產品
  - 如軟體工程師的職業產生軟體
  - IT工程師的職業產生 IT 服務
- 每種產品會有不同的原料需求，有實體原料也可能有虛擬原料
  - 如軟體公司的工作會產生軟體，可能不需要原料
  - 軟體公司的產品為軟體，軟體本身也有種類，軟體公司的工作產生的產品(軟體)也可能作為另一間軟體公司的工作所需的原料(SAAS)
  - 如鋼鐵業公司的工作會產生鐵加工品，需要鐵原料
  - 一份工作所需求的原料可能是複數種類
  - 一份工作所產生的產品限制為單種類
  - 工作的產業別-原料-產品配置不能寫死，需要抽出來可以被獨立配置
  - 實體產品大部分會在商業區進行上架販售
- 實體產品會被車輛運送到他的目的地，如倉庫，城市外，城市內某個住宅，城市內另一間公司做為新的產品的需求原料
- 虛擬產品會在網站上販售，不需要車輛運送

### 公司系統

- 非住宅建築可以容納公司
- 公司有名稱、類型和所屬建築
- 公司有產業別，不同產業別的公司產生不同的工作類型
  - 大型公司可能有自己的 IT 職位，但小型公司會購買虛擬的 IT 產品服務
- 公司對於原物料的需求來自不同產業別，比如餐廳需求農田產物跟牧場產物

### 交通系統

- 實現路徑查找算法，計算最短路徑
- 支持車輛在道路上移動
- 車輛可以運輸產品和人員
- 車輛有擁有者（公司）和目的地

### 資源和經濟系統

- 實現物品和資源的基本生產和消費系統
- 公司可以根據配方生產產品
- 產品可以在不同公司之間運輸和交易
- 追蹤公司的庫存和產品流通

### 遊戲控制

- 實現暫停/繼續功能
- 提供遊戲速度調整（1x, 2x, 3x）
- 顯示當前遊戲時間和狀態
- 提供統計數據面板（人口、建築數量等）

### 用戶界面

- 主世界地圖視圖
- FPS顯示器
- 遊戲控制面板
- 通用統計信息面板
- 建築信息面板
- 所有類別的實體列表掌握詳細資訊
- 各元素應有清晰的布局和樣式

## 架構要求

### 模型架構

- 實體模型：居民(Citizen)、工作(Job)、行動(Action)、公司(Company)、產品(Product)、配方(Recipe)
- 每個模型應有明確的屬性和方法

### 組件架構

- 主應用組件(GameApp)
- 世界地圖組件(WorldMap)
- 地圖方塊組件(MapBlock)
- 建築組件(MapBuilding)
- 居民組件(MapCitizen)
- 車輛組件(MapVehicle)
- FPS顯示器組件(FpsHud)
- 遊戲控制組件(GameControlHud)
- 統計信息組件(GeneralStatisticsHud)
- 建築信息組件(BuildingHud)
- 公司列表組件(CompanyList)
- 居民列表組件(CitizenList)
- 產品列表組件(ProductList)
- 車輛列表組件(VehicleList)

## 視覺設計

- 使用網格風格地圖視圖
- 使用簡潔的色彩方案區分不同類型的地形和建築
- 居民和車輛以小圖標展示在地圖上
- 統計和控制面板使用半透明背景與深色文字
- 所有元素應適應不同屏幕尺寸

## 效能要求

- 網頁應保持流暢運行，FPS維持在至少30幀/秒
- 即使人口增長到數百人，系統也應保持穩定

## 遊戲循環

### 基本

- 產生地圖
- 根據需求產生建築
- 根據需求做人口出生/移入動作
- 人口移入城市時決定住址跟工作地點
- 公司根據員工數量開始開發產品
- 產品在不同產業間流動
- 人在不同地點間移動

## 其他需求

- 確保代碼模塊化和可擴展性
